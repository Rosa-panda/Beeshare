# BeeShare时间管理工具使用指南

## 什么是时间管理工具？

在软件开发中，正确处理时间非常重要。BeeShare系统提供了一套简单易用的时间管理工具，可以帮助你：

- 获取准确的时间（包括从网络获取的标准时间）
- 自动更新文件中的日期信息
- 执行日期计算和格式化

不需要有任何编程经验，你也能轻松使用这些工具！

## 时间工具的分类

BeeShare系统中有三种主要的时间工具：

1. **网络时间工具** (`time_utils.py`) - 获取准确的网络时间
2. **日期计算工具** (`date_utils.py`) - 计算过去或未来的日期
3. **日期更新工具** (`update_docstring_dates.py`) - 自动更新文件中的日期信息

## 如何使用网络时间工具

### 功能介绍

网络时间工具可以让你获取准确的时间，不受本地电脑时间设置的影响。这对于保证数据分析和记录的准确性非常重要！

### 使用方法

```python
# 导入网络时间工具
from src.utils.time_utils import get_network_time, get_formatted_date

# 获取当前网络时间（返回一个datetime对象）
current_time = get_network_time()
print(f"当前网络时间: {current_time}")

# 获取格式化的日期字符串（默认格式为 YYYY-MM-DD）
today = get_formatted_date()
print(f"今天日期: {today}")

# 使用自定义格式获取日期
custom_date = get_formatted_date('%Y年%m月%d日')
print(f"中文格式日期: {custom_date}")  # 例如：2024年05月20日
```

### 日期格式符号说明

| 格式符号 | 含义 | 示例 |
|---------|------|------|
| %Y | 四位数年份 | 2024 |
| %m | 两位数月份 | 05 |
| %d | 两位数日期 | 20 |
| %H | 两位数小时（24小时制） | 14 |
| %M | 两位数分钟 | 30 |
| %S | 两位数秒钟 | 45 |

## 如何使用日期计算工具

### 功能介绍

日期计算工具可以帮助你计算过去的日期，比如获取90天前的日期。这在获取历史数据时特别有用！

### 使用方法

```python
# 导入日期计算工具
from src.utils.date_utils import get_date_n_days_ago

# 获取90天前的日期（默认值）
ninety_days_ago = get_date_n_days_ago()
print(f"90天前: {ninety_days_ago}")

# 获取30天前的日期
thirty_days_ago = get_date_n_days_ago(n=30)
print(f"30天前: {thirty_days_ago}")

# 使用自定义格式获取10天前的日期
ten_days_ago = get_date_n_days_ago(n=10, date_format='%Y%m%d')
print(f"10天前(年月日格式): {ten_days_ago}")  # 例如：20240510
```

## 如何使用日期更新工具

### 功能介绍

日期更新工具可以自动更新项目中Python文件的文档字符串中的日期信息。这是一个很酷的功能，可以确保你的文件创建日期和修改日期始终保持准确！

### 使用方法

1. **基本使用** - 更新所有Python文件的最后修改日期：

```bash
python tools/update_docstring_dates.py
```

2. **只更新某个目录** - 指定要扫描的目录：

```bash
python tools/update_docstring_dates.py --dir src/analysis
```

3. **更新创建日期** - 默认只更新最后修改日期，如果也想更新创建日期：

```bash
python tools/update_docstring_dates.py --creation
```

4. **试运行模式** - 查看会更新哪些文件，但不实际更改文件：

```bash
python tools/update_docstring_dates.py --dry-run
```

### 参数说明

| 参数 | 说明 | 默认值 |
|------|------|--------|
| --dir | 要扫描的目录 | 项目根目录 |
| --ext | 要处理的文件扩展名 | .py |
| --creation | 是否更新创建日期 | 不更新 |
| --no-modified | 不更新最后修改日期 | 默认更新 |
| --dry-run | 模拟运行，不实际修改文件 | 默认实际修改 |

## 使用小技巧

1. **批量更新** - 在提交代码前，运行一次更新工具，确保所有修改过的文件都有正确的日期
2. **自定义日期格式** - 根据需要，你可以使用各种日期格式（推荐使用'%Y-%m-%d'这种国际标准格式）
3. **获取可靠时间** - 始终使用`get_network_time()`而不是`datetime.now()`获取时间，这样可以避免本地时间设置不准确的问题

## 运行示例

我们提供了一系列示例脚本，帮助你更好地理解和使用时间管理工具。这些示例位于 `docs/examples` 目录中：

### 示例文件

1. **网络时间工具示例** (`network_time_example.py`) - 演示如何获取和使用网络时间
2. **日期计算工具示例** (`date_utils_example.py`) - 演示如何计算过去的日期和进行日期操作
3. **文档日期更新工具示例** (`update_dates_example.py`) - 演示如何更新文件中的日期信息

### 运行示例

你可以使用我们提供的便捷脚本来运行这些示例：

#### Windows用户

在Windows系统中，你可以双击 `run_examples.bat` 文件，然后根据菜单选择要运行的示例：

```
BeeShare时间管理工具示例
=================================

请选择要运行的示例:
1. 网络时间工具示例
2. 日期计算工具示例
3. 文档日期更新工具示例
4. 运行所有示例
0. 退出

请输入选项 (0-4):
```

#### Linux/Mac用户

在Linux或Mac系统中，你可以在终端中运行以下命令：

```bash
# 首先确保脚本有执行权限
chmod +x run_examples.sh

# 然后运行脚本
./run_examples.sh
```

然后根据菜单选择要运行的示例。

### 自己尝试修改示例

学习编程的最好方法是动手实践！试着修改这些示例，看看会发生什么：

1. 尝试更改日期格式字符串，看看输出结果如何变化
2. 修改日期计算的天数，比如计算365天前是什么日期
3. 创建自己的Python文件，然后使用日期更新工具更新其中的日期信息

## 常见问题解答

### 问题1：为什么要使用网络时间而不是系统时间？

**答**：网络时间通常更准确，不受本地电脑时钟设置的影响。特别是当多人协作开发时，使用统一的网络时间可以避免因个人电脑时间设置不同导致的混乱。

### 问题2：如果网络无法连接，get_network_time()会返回什么？

**答**：如果无法从网络获取时间（比如网络断开），函数会自动回退到使用系统本地时间，并在日志中记录一条警告信息。这样设计可以确保程序在任何情况下都能继续运行。

### 问题3：我可以使用这些工具来获取未来的日期吗？

**答**：目前`date_utils.py`中只实现了获取过去日期的函数。如果你需要获取未来日期，可以参考已有代码，编写类似的函数，只需要将`timedelta(days=n)`中的n改为负数即可。

### 问题4：更新工具会更新哪些文件中的日期？

**答**：更新工具会扫描指定目录中的所有Python文件（`.py`后缀），找出其中包含"创建日期:"或"最后修改:"文本的文档字符串，然后用当前日期更新这些信息。

## 进阶使用

如果你有编程经验，你还可以在自己的脚本中集成这些时间工具：

```python
# 在自己的项目中使用时间工具
from src.utils.time_utils import get_formatted_date
from src.utils.date_utils import get_date_n_days_ago

# 设置日期范围
end_date = get_formatted_date()  # 今天
start_date = get_date_n_days_ago(n=30)  # 30天前

print(f"从 {start_date} 到 {end_date} 的数据")
```

---

如有其他问题，欢迎随时咨询！ 